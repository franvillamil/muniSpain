#' Adapt Spanish (and Catalan) encoding when using UTF8.
#'
#' Adapts Spanish encoding when using UTF8, deleting accents (tildes) and
#' turning ñ into n, ç into c, ü into u.
#'
#' @param data Character vector or data frame. If data frame, converts
#'   all columns of class character.
#' @param tolower If TRUE, returns lower-case. Logical, default = FALSE.
#'
#' @return Same object as input, adapted.
#'
#' @examples
#' adapt("Ñora")
#' adapt("Lledó", tolower = TRUE)
#'
#' @export
adapt = function(data, tolower = FALSE){

if (class(data) == "character"){

  data = gsub("\302\241", "", data)
  data = gsub("\302\252", "", data)
  data = gsub("\302\272", "", data)
  data = gsub("\302\277", "", data)
  data = gsub("\303\200", "A", data)
  data = gsub("\303\201", "A", data)
  data = gsub("\303\202", "A", data)
  data = gsub("\303\203", "A", data)
  data = gsub("\303\204", "A", data)
  data = gsub("\303\207", "C", data)
  data = gsub("\303\210", "E", data)
  data = gsub("\303\211", "E", data)
  data = gsub("\303\212", "E", data)
  data = gsub("\303\213", "E", data)
  data = gsub("\303\214", "I", data)
  data = gsub("\303\215", "I", data)
  data = gsub("\303\216", "I", data)
  data = gsub("\303\217", "I", data)
  data = gsub("\303\221", "N", data)
  data = gsub("\303\222", "O", data)
  data = gsub("\303\223", "O", data)
  data = gsub("\303\224", "O", data)
  data = gsub("\303\225", "O", data)
  data = gsub("\303\226", "O", data)
  data = gsub("\303\231", "U", data)
  data = gsub("\303\232", "U", data)
  data = gsub("\303\233", "U", data)
  data = gsub("\303\234", "U", data)
  data = gsub("\303\240", "a", data)
  data = gsub("\303\241", "a", data)
  data = gsub("\303\242", "a", data)
  data = gsub("\303\243", "a", data)
  data = gsub("\303\244", "a", data)
  data = gsub("\303\247", "c", data)
  data = gsub("\303\250", "e", data)
  data = gsub("\303\251", "e", data)
  data = gsub("\303\252", "e", data)
  data = gsub("\303\253", "e", data)
  data = gsub("\303\254", "i", data)
  data = gsub("\303\255", "i", data)
  data = gsub("\303\256", "i", data)
  data = gsub("\303\257", "i", data)
  data = gsub("\303\261", "n", data)
  data = gsub("\303\262", "o", data)
  data = gsub("\303\263", "o", data)
  data = gsub("\303\264", "o", data)
  data = gsub("\303\265", "o", data)
  data = gsub("\303\266", "o", data)
  data = gsub("\303\271", "u", data)
  data = gsub("\303\272", "u", data)
  data = gsub("\303\274", "u", data)
  # short Octal
  data = gsub("\241", "", data)
  data = gsub("\252", "", data)
  data = gsub("\272", "", data)
  data = gsub("\277", "", data)
  data = gsub("\300", "A", data)
  data = gsub("\301", "A", data)
  data = gsub("\302", "A", data)
  data = gsub("\303", "A", data)
  data = gsub("\304", "A", data)
  data = gsub("\307", "C", data)
  data = gsub("\310", "E", data)
  data = gsub("\311", "E", data)
  data = gsub("\312", "E", data)
  data = gsub("\313", "E", data)
  data = gsub("\314", "I", data)
  data = gsub("\315", "I", data)
  data = gsub("\316", "I", data)
  data = gsub("\317", "I", data)
  data = gsub("\321", "N", data)
  data = gsub("\322", "O", data)
  data = gsub("\323", "O", data)
  data = gsub("\324", "O", data)
  data = gsub("\325", "O", data)
  data = gsub("\326", "O", data)
  data = gsub("\331", "U", data)
  data = gsub("\332", "U", data)
  data = gsub("\333", "U", data)
  data = gsub("\334", "U", data)
  data = gsub("\340", "a", data)
  data = gsub("\341", "a", data)
  data = gsub("\342", "a", data)
  data = gsub("\343", "a", data)
  data = gsub("\344", "a", data)
  data = gsub("\347", "c", data)
  data = gsub("\350", "e", data)
  data = gsub("\351", "e", data)
  data = gsub("\352", "e", data)
  data = gsub("\353", "e", data)
  data = gsub("\354", "i", data)
  data = gsub("\355", "i", data)
  data = gsub("\356", "i", data)
  data = gsub("\357", "i", data)
  data = gsub("\361", "n", data)
  data = gsub("\362", "o", data)
  data = gsub("\363", "o", data)
  data = gsub("\364", "o", data)
  data = gsub("\365", "o", data)
  data = gsub("\366", "o", data)
  data = gsub("\371", "u", data)
  data = gsub("\372", "u", data)
  data = gsub("\374", "u", data)

  data = gsub("<U\\+00F1>", "n", data)
  data = gsub("<U\\+00F3>", "o", data)
  data = gsub("<U\\+00ED>", "i", data)
  data = gsub("<U\\+00E9>", "e", data)
  data = gsub("<U\\+00E1>", "a", data)
  data = gsub("<U\\+00FC>", "u", data)
  data = gsub("<U\\+00BF>", "?", data)
  data = gsub("<U\\+00FA>", "u", data)
  data = gsub("<U\\+00DA>", "U", data)

  data = gsub(" - ", "-", data)


  if(tolower == TRUE){ data = tolower(data) }
  return(data)

} else if (class(data) == "data.frame"){

  # get character variables
  vars = labels(which(lapply(data, class) == "character"))

  # for each variable, transform
  for (i in vars){
    # long Octal
    data[, i] = gsub("\302\241", "", data[, i])
    data[, i] = gsub("\302\252", "", data[, i])
    data[, i] = gsub("\302\272", "", data[, i])
    data[, i] = gsub("\302\277", "", data[, i])
    data[, i] = gsub("\303\200", "A", data[, i])
    data[, i] = gsub("\303\201", "A", data[, i])
    data[, i] = gsub("\303\202", "A", data[, i])
    data[, i] = gsub("\303\203", "A", data[, i])
    data[, i] = gsub("\303\204", "A", data[, i])
    data[, i] = gsub("\303\207", "C", data[, i])
    data[, i] = gsub("\303\210", "E", data[, i])
    data[, i] = gsub("\303\211", "E", data[, i])
    data[, i] = gsub("\303\212", "E", data[, i])
    data[, i] = gsub("\303\213", "E", data[, i])
    data[, i] = gsub("\303\214", "I", data[, i])
    data[, i] = gsub("\303\215", "I", data[, i])
    data[, i] = gsub("\303\216", "I", data[, i])
    data[, i] = gsub("\303\217", "I", data[, i])
    data[, i] = gsub("\303\221", "N", data[, i])
    data[, i] = gsub("\303\222", "O", data[, i])
    data[, i] = gsub("\303\223", "O", data[, i])
    data[, i] = gsub("\303\224", "O", data[, i])
    data[, i] = gsub("\303\225", "O", data[, i])
    data[, i] = gsub("\303\226", "O", data[, i])
    data[, i] = gsub("\303\231", "U", data[, i])
    data[, i] = gsub("\303\232", "U", data[, i])
    data[, i] = gsub("\303\233", "U", data[, i])
    data[, i] = gsub("\303\234", "U", data[, i])
    data[, i] = gsub("\303\240", "a", data[, i])
    data[, i] = gsub("\303\241", "a", data[, i])
    data[, i] = gsub("\303\242", "a", data[, i])
    data[, i] = gsub("\303\243", "a", data[, i])
    data[, i] = gsub("\303\244", "a", data[, i])
    data[, i] = gsub("\303\247", "c", data[, i])
    data[, i] = gsub("\303\250", "e", data[, i])
    data[, i] = gsub("\303\251", "e", data[, i])
    data[, i] = gsub("\303\252", "e", data[, i])
    data[, i] = gsub("\303\253", "e", data[, i])
    data[, i] = gsub("\303\254", "i", data[, i])
    data[, i] = gsub("\303\255", "i", data[, i])
    data[, i] = gsub("\303\256", "i", data[, i])
    data[, i] = gsub("\303\257", "i", data[, i])
    data[, i] = gsub("\303\261", "n", data[, i])
    data[, i] = gsub("\303\262", "o", data[, i])
    data[, i] = gsub("\303\263", "o", data[, i])
    data[, i] = gsub("\303\264", "o", data[, i])
    data[, i] = gsub("\303\265", "o", data[, i])
    data[, i] = gsub("\303\266", "o", data[, i])
    data[, i] = gsub("\303\271", "u", data[, i])
    data[, i] = gsub("\303\272", "u", data[, i])
    data[, i] = gsub("\303\274", "u", data[, i])
    # short Octal
    data[, i] = gsub("\241", "", data[, i])
    data[, i] = gsub("\252", "", data[, i])
    data[, i] = gsub("\272", "", data[, i])
    data[, i] = gsub("\277", "", data[, i])
    data[, i] = gsub("\300", "A", data[, i])
    data[, i] = gsub("\301", "A", data[, i])
    data[, i] = gsub("\302", "A", data[, i])
    data[, i] = gsub("\303", "A", data[, i])
    data[, i] = gsub("\304", "A", data[, i])
    data[, i] = gsub("\307", "C", data[, i])
    data[, i] = gsub("\310", "E", data[, i])
    data[, i] = gsub("\311", "E", data[, i])
    data[, i] = gsub("\312", "E", data[, i])
    data[, i] = gsub("\313", "E", data[, i])
    data[, i] = gsub("\314", "I", data[, i])
    data[, i] = gsub("\315", "I", data[, i])
    data[, i] = gsub("\316", "I", data[, i])
    data[, i] = gsub("\317", "I", data[, i])
    data[, i] = gsub("\321", "N", data[, i])
    data[, i] = gsub("\322", "O", data[, i])
    data[, i] = gsub("\323", "O", data[, i])
    data[, i] = gsub("\324", "O", data[, i])
    data[, i] = gsub("\325", "O", data[, i])
    data[, i] = gsub("\326", "O", data[, i])
    data[, i] = gsub("\331", "U", data[, i])
    data[, i] = gsub("\332", "U", data[, i])
    data[, i] = gsub("\333", "U", data[, i])
    data[, i] = gsub("\334", "U", data[, i])
    data[, i] = gsub("\340", "a", data[, i])
    data[, i] = gsub("\341", "a", data[, i])
    data[, i] = gsub("\342", "a", data[, i])
    data[, i] = gsub("\343", "a", data[, i])
    data[, i] = gsub("\344", "a", data[, i])
    data[, i] = gsub("\347", "c", data[, i])
    data[, i] = gsub("\350", "e", data[, i])
    data[, i] = gsub("\351", "e", data[, i])
    data[, i] = gsub("\352", "e", data[, i])
    data[, i] = gsub("\353", "e", data[, i])
    data[, i] = gsub("\354", "i", data[, i])
    data[, i] = gsub("\355", "i", data[, i])
    data[, i] = gsub("\356", "i", data[, i])
    data[, i] = gsub("\357", "i", data[, i])
    data[, i] = gsub("\361", "n", data[, i])
    data[, i] = gsub("\362", "o", data[, i])
    data[, i] = gsub("\363", "o", data[, i])
    data[, i] = gsub("\364", "o", data[, i])
    data[, i] = gsub("\365", "o", data[, i])
    data[, i] = gsub("\366", "o", data[, i])
    data[, i] = gsub("\371", "u", data[, i])
    data[, i] = gsub("\372", "u", data[, i])
    data[, i] = gsub("\374", "u", data[, i])

    data[, i] = gsub("<U\\+00F1>", "n", data[, i])
    data[, i] = gsub("<U\\+00F3>", "o", data[, i])
    data[, i] = gsub("<U\\+00ED>", "i", data[, i])
    data[, i] = gsub("<U\\+00E9>", "e", data[, i])
    data[, i] = gsub("<U\\+00E1>", "a", data[, i])
    data[, i] = gsub("<U\\+00FC>", "u", data[, i])
    data[, i] = gsub("<U\\+00BF>", "?", data[, i])
    data[, i] = gsub("<U\\+00FA>", "u", data[, i])
    data[, i] = gsub("<U\\+00DA>", "U", data[, i])

    data[, i] = gsub(" - ", "-", data[, i])

    if(tolower == TRUE){ data[, i] = tolower(data[, i]) }
  }

  return(data)

} else {stop("no character variable?")}

}
